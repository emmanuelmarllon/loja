generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model produtos {
  id          String   @id @default(uuid()) @map("_id")
  name        String   @unique
  shortDesc   String
  description String
  price       Float
  discount    Int
  category    String
  details     Json
  featured    Boolean
  image       String
  gallery     Json
  createdAt   DateTime @default(now())
  reviews     Review[] // relação com reviews
}

model Usuario {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  user      String   @unique
  email     String   @unique
  name      String
  password  String
  isAdmin   Boolean  @default(false)
  createdAt DateTime @default(now()) @db.Date
  reviews   Review[] // relação com reviews
}

model Purchase {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  userId    String   @db.ObjectId
  total     Float
  items     Json
  txid      String   @unique
  status    String
  createdAt DateTime @default(now())
}

model Review {
  id        String   @id @default(uuid()) @map("_id")          // UUID agora
  userId    String   @db.ObjectId                             // mantemos ObjectId do usuário
  productId String                                           // UUID do produto
  comment   String
  rating    Int
  createdAt DateTime @default(now())

  // Relações
  user     Usuario  @relation(fields: [userId], references: [id])
  product  produtos @relation(fields: [productId], references: [id])
}
